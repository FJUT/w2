<!DOCTYPE HTML>
<html>
  <head>
    <title>LeanEngine</title>
    <link rel="stylesheet" href="/stylesheets/style.css">
    <style>
    img {
    WIDTH: 70%;
}
    </style>
  </head>
  <body>
    <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="https">Https</h1><blockquote><p>建议使用 <code>Node v6</code> 或以上版本，否则会存在性能问题，及在Chrome或APP上抓包HTTPS请求会有问题。</p><p><strong>在iOS上安装根证书时，需要先关闭<code>HTTPS拦截</code>，否则将显示安装失败。</strong></p></blockquote><p>
                                下载地址：<a href="/whistle/cgi-bin/rootca">/whistle/cgi-bin/rootca</a>
                                </p><p><img alt="Https" src="https://wproxy.org/whistle/img/https.gif"></p><h2 id="安装根证书">安装根证书</h2><blockquote><p>证书按下面步骤安装后，如果还出现安全提醒，这个主要原因是之前你访问过该页面，导致长连接已建立，可以等段时间再访问、或重新打开浏览器</p></blockquote><p>如上图下载完根证书后点击rootCA.crt文件，弹出根证书安装对话框。</p><ol><li><p>Windows:</p><p><a href="https://msdn.microsoft.com/zh-cn/library/cc750534.aspx" target="_blank">Installing a root certificate on Windows</a></p><p><img alt="img" src="https://wproxy.org/whistle/img/windows_rootca.jpeg"></p><p>下载证书后，双击证书，根据指引安装证书。证书安装过程，要确保证书存储到<code>受信任的根证书颁发机构</code>下。</p></li>
<li><p>Mac: <a href="http://zhidao.baidu.com/link?url=bQ8ZnDTxUIlqruQ56NYjBmwztWPlZtv9AIRazkoKeMsdpAq7mcwXOHQduRwmHV1M2hf143vqBxHzKb1tg0L03DJoj6XS109P8zBNF1E9uU_" target="_blank">Mac根证书怎么安装</a></p><p>Mac 安装证书后，需要手动信任证书，步骤如下：</p><p>打开证书管理界面，找到带有 <code>whistle</code> 的字样的证书，如果有多个又不确定最新安装的是哪个，可以全部删除后重新安装</p><p><img alt="img" src="https://ae01.alicdn.com/kf/HTB1ZtoBdYsTMeJjSszh763GCFXai.png"></p><p>双击证书后，点击 <code>Trust</code> 左边展开选项，红色部分选择 <code>Always Trust</code> （总是信任），点击左上角关闭当前界面会要求输入密码；输入密码后可
以看到证书上面红色的图标 <code>x</code> 不见了，到这一步说明完成证书安装。</p><p><img alt="img" src="https://ae01.alicdn.com/kf/HTB1UWItd8USMeJjy1zk761WmpXaT.png"></p></li>
<li><p>Firefox:</p><p>菜单 &gt; 首选项 &gt; 高级 &gt; 证书 &gt; 证书机构 &gt; 导入 -&gt; 选中所有checkbox -&gt; 确定</p></li>
<li><p>Linux Chrome(Chromium): 参照这个<a href="http://www.richud.com/wiki/Ubuntu_chrome_browser_import_self_signed_certificate" target="_blank">教程</a></p><ul><li>地址栏输入<code>chrome://settings/</code>
</li>
<li>Show advanced Settings &gt; Manage certificates &gt; Authorities &gt; Import
</li>
<li>选择证书后确认，重启浏览器
</li>
<li>done
</li></ul>
<p><img alt="ubuntu Chromium" src="https://cloud.githubusercontent.com/assets/16034964/20553721/9c3d1bda-b191-11e6-880f-9fd6976b95cc.png"></p></li>
<li><p>手机</p><p><strong>iOS</strong></p><ul><li>手机设置代理后，Safari 地址栏输入 <code>rootca.pro</code>，按提示安装证书（或者通过 <code>whistle</code> 控制台的二维码扫码安装，iOS安装根证书需要到连接远程服务器进行验证，需要暂时把<strong>Https拦截功能关掉</strong>）
</li>
<li>iOS 10.3 之后需要手动信任自定义根证书，设置路径：<code>Settings &gt; General &gt; About &gt; Certificate Trust Testings</code>
</li></ul>
<p><a href="http://www.neglectedpotential.com/2017/04/trusting-custom-root-certificates-on-ios-10-3/" target="_blank">具体可以看这里</a></p><p><img src="https://wproxy.org/whistle/img/ios10.3_ca.PNG" width="320"></p><p><strong>Android</strong></p><ul><li><code>whistle</code> 控制台二维码扫码安装，或者浏览器地址栏 <code>rootca.pro</code> 按提示安装
</li>
<li>部分浏览器不会自动识别 ca 证书，可以通过 Android Chrome 来完成安装
</li>
<li><p>android 6.0 之后的一些app在成功安装证书后仍然无法对https连接进行手抓包，有可能是该app没有添加信任用户自定义证书的权限。请确认该app是否有如下配置：</p><pre><code>&lt;base-config cleartextTrafficPermitted="true"&gt;
   &lt;trust-anchors&gt;
       &lt;certificates src="system" /&gt;
       &lt;certificates src="user" /&gt;
   &lt;/trust-anchors&gt;
&lt;/base-config&gt;</code></pre>
<p>这主要是因为android 6.0之后的版本默认配置发生了变化，<a href="https://developer.android.com/training/articles/security-config#base-config" target="_blank">更多请看Android开发文档</a>。</p></li></ul>
</li></ol>
<h2 id="开启拦截https">开启拦截HTTPS</h2><p>图中的打开的对话框有两个checkbox(<strong>在iOS安装根证书的时候，记得不要开启 <del><code>Intercept HTTPS CONNECTs</code></del> <code>Capture HTTPS CONNECTs</code>，否则将无法安装成功</strong>)：</p><ol><li><del><code>Hide HTTPS CONNECTs</code></del>：隐藏<code>connect</code>类型的请求
</li>
<li><del><code>Intercept HTTPS CONNECTs</code></del> <code>Capture HTTPS CONNECTs</code>：开启Https拦截功能，只有勾上这个checkbox及装好根证书，whistle才能看到HTTPS、Websocket的请求
</li>
<li><p>也可以通过配置来开启对部分请求的Https拦截功能</p><pre><code class="lang-plain">www.test.com filter://intercept
/alibaba-inc/ filter://intercept</code></pre>
<ol><li>如果想过滤部分请求不启用Https拦截功能
</li></ol>
<pre><code class="lang-plain"># 指定域名
www.baidu.com  disable://intercept

# 通过正则
/baidu/ disable://intercept

# 不支持通过路径的方式设置</code></pre>
</li></ol>

                                
                                </section>
                            
    </div>
</div>

                        </div>
    <p><a href="/todos">一个简单的「TODO 列表」示例</a></p>
  </body>
</html>
